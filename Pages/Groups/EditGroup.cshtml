@page
@model CNSVM.Pages.Groups.EditGroupModel
@{
}
<div class="container-fluid mt-4">
    <form method="post">
        <div class="form-group mt-4" id="justificationSection">
            <label class="form-label">Nombre del grupo:</label>
            <input asp-for="Group.Name" class="form-control" />
            <span asp-validation-for="Group.Name" class="text-danger"></span>
            @if (ViewData.ModelState.ContainsKey("Group"))
            {
                <div class="text-danger">
                    @ViewData.ModelState["Group"].Errors.First().ErrorMessage
                </div>
            }
        </div>
        <input type="text" name="ids" hidden />

        <!-- Listas de doctores y miembros -->
        <div class="row mt-4">
            <!-- Doctores disponibles -->
            <div class="card-body col-md-6 mb-4">
                <table id="table-doctors" class="table table-bordered">
                    <thead>
                        <tr>
                            <th colspan="2" class="text-center">Doctores disponibles</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Doctors != null)
                        {
                            @foreach (var doctor in Model.Doctors)
                            {
                                <tr class="doctor-row">
                                    <td hidden>
                                        <input type="hidden" name="DoctorId" value="@doctor.Id" />
                                    </td>
                                    <td class="doctor-name">@doctor.Name @doctor.FirstName @doctor.LastName</td>
                                    <td class="doctor-action">
                                        <button type="submit" name="action" value="add-@doctor.Id" class="btn-plus btn-sm btn-primary">+</button>
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>

            <!-- Miembros -->
            <div class="card-body col-md-6 mb-4">
                <table id="table-members" class="table table-bordered">
                    <thead>
                        <tr>
                            <th colspan="2" class="text-center">Miembros</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.User != null)
                        {
                           @*  @foreach (var member in Model.User)
                            {
                                <tr class="doctor-row">
                                    <td hidden>
                                        <input type="hidden" name="MemberId" value="@member.Id" />
                                    </td>
                                    <td class="doctor-name">@member.Name @member.FirstName @member.LastName</td>
                                    <td class="doctor-action">
                                        <button type="submit" name="action" value="remove-@member.Id" class="btn-minus btn-sm btn-danger">-</button>
                                    </td>
                                </tr>
                            } *@
                        }
                        else
                        {
                            <tr id="no-members-message">
                                <td colspan="2" class="text-center">Todavía no existen miembros</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Botones Aceptar y Cancelar -->
        <div class="text-center mt-4">
            <button type="submit" name="save" class="btn btn-success mx-2">Aceptar</button>
            <a asp-page="./Index" class="btn btn-secondary mx-2">Cancelar</a>
        </div>
    </form>
</div>

<style>
    /* Reutilizamos los mismos estilos de la vista de creación */
    #table-doctors tbody, #table-members tbody {
        display: block;
        max-height: 400px;
        overflow-y: auto;
    }

    #table-doctors, #table-members {
        width: 100%;
    }

    /* Flex layout para cada fila de doctor */
    .doctor-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
    }

    /* Estilo de la celda del nombre del doctor */
    .doctor-name {
        flex-grow: 1;
        padding-right: 10px;
    }

    /* Ajustes del botón de acción */
    .doctor-action {
        flex: 0 0 40px; /* Espacio fijo para el botón */
        display: flex;
        justify-content: center;
    }

        .doctor-action button {
            width: 100%;
        }

    /* Estilo para que las tablas ocupen más espacio vertical y horizontal */
    .card-body {
        height: 500px; /* Ajustar la altura del contenedor */
    }
</style>
